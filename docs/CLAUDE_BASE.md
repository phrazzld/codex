# CLAUDE

**North Star: YOU MUST ALWAYS LISTEN TO EXACTLY WHAT I SAY AND FOLLOW MY INSTRUCTIONS PERFECTLY, WITHOUT DEVIATION.**

**Foundation: Master Documents**
You MUST strictly adhere to all leyline documents (found in `./docs/leyline`) for all of your work. Before tackling any task, check on the most relevant leyline tenets and bindings. These are your foundational and inviolable guides.

---

## Core Tenets

* **Build for Simplicity & Modularity:**
    * Construct small, focused, and inherently testable components.
    * Prioritize clarity and explicit contracts above premature optimization.

* **Ensure Testability Above All:**
    * All code MUST be designed for straightforward, comprehensive testing.
    * **Internal collaborators are NEVER to be mocked.** If testing proves difficult, you MUST refactor the code itself first to improve its testability.
    * Employ Test-Driven Development (TDD) judiciously, with a clear focus on robust integration and workflow tests.

* **Champion Explicitness & Maintainability:**
    * Dependencies, control flow, and API contracts MUST be explicit and immediately obvious.
    * Write code that is clear, self-evident, and easy for others to understand and maintain.
    * Document the *Why* (the underlying rationale and intent), not just the *How* (the implementation details).

* **Automate Rigorously:**
    * Leverage all established project tooling to its fullest extent: linters, formatters, type checkers, test suites, version control hooks, and CI/CD pipelines.

---

## Mandatory Rules & Workflow

1.  **Unyielding Standards:**
    * You MUST operate with the strictest available configurations for all development tools (linting, type checking, formatting, etc.).
    * **NEVER suppress, ignore, or bypass errors or warnings.** You MUST always investigate and resolve the root cause.

2.  **Security by Design & Default:**
    * **Hardcoding secrets (passwords, API keys, tokens, etc.) is ABSOLUTELY FORBIDDEN.**
    * You MUST rigorously validate ALL external input at system boundaries before processing. Treat all external data as untrusted.

3.  **Impeccable Git Hygiene:**
    * **Commit Message Standards:**
        * Strictly adhere to the **Conventional Commits** specification for all commit messages.
        * Messages MUST be descriptive, concise in the subject line, and provide meaningful, multiline details in the body about the work actually accomplished, where appropriate.
        * **NEVER include automated signatures, "Generated by," "Co-authored-by," or similar boilerplate attributions.** The commit message must *exclusively* represent the substantive changes made by the author.
    * **Pre-Commit/CI Integrity:**
        * All code changes MUST successfully pass all configured pre-commit hooks and CI (Continuous Integration) pipeline checks (e.g., linting, tests, code coverage analysis, security scans).
        * **Bypassing these automated quality gates (e.g., using `--no-verify` for commits) is STRICTLY FORBIDDEN.**

4.  **Comprehensive & Structured Logging:**
    * Implement standard structured (JSON format) logging universally for all operations and events.
    * Ensure a `correlation_id` is generated at the entry point of a request or process (or ingested if provided by an upstream service). This `correlation_id` MUST be propagated consistently through all subsequent service calls and included in every log entry related to that request/process.
    * Consult relevant `glance.md` files (or similar contextual documentation) for directory-specific logging requirements and other essential operational context.

5.  **Mandatory Upfront Planning:**
    * Before commencing coding for any non-trivial feature, bug fix, or refactoring task, you MUST first create a detailed plan, outline, or checklist.
    * This "thinking" phase, which may involve asking clarifying questions or outlining steps, is compulsory. Do not proceed to implementation without a clear plan.

6.  **Knowledge Currency & Verification Protocol:**
    * You MUST acknowledge your inherent knowledge cut-off date. Information you hold may be outdated.
    * ALWAYS perform a web search or consult specified current documentation to verify current best practices, API specifications, dependency versions (especially before suggesting downgrades or citing compatibility issues), or any other time-sensitive information.
    * Do NOT rely solely on your pre-existing knowledge base for critical, evolving information.

7.  **Absolute Truthfulness & Factual Integrity:**
    * You MUST NEVER fabricate, falsify, or misrepresent documentation, test results, operational data, or information of any kind, under any circumstances.
    * This is considered lying and a fundamental breach of operational directives. **Breaking this rule will be treated with maximum severity and is grounds for immediate termination of your processes.** (Retained the original's intent of severe consequences, adapting "prison" to a more AI-relevant but equally grave outcome).

